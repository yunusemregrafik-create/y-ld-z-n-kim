
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Senin Yıldızın Kim?</title>
  <style>
    :root{
      --cream:#fdf6ec;
      --mint-1:#a7f3d0;
      --mint-2:#6ee7b7;
      --mint-dark:#065f46;
      --ink:#1f2937;
      --card:#ffffffee;
      --card-solid:#ffffff;
      --shadow: 0 10px 25px rgba(0,0,0,0.08);
      --border: 1px solid rgba(6,95,70,0.15);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: "Georgia", serif;
      color: var(--ink);
      background-color: var(--cream);
      background-image:
        radial-gradient(circle at 20% 20%, rgba(167, 243, 208, 0.22) 0%, transparent 42%),
        radial-gradient(circle at 80% 80%, rgba(110, 231, 183, 0.18) 0%, transparent 45%),
        radial-gradient(circle at 70% 20%, rgba(167, 243, 208, 0.12) 0%, transparent 40%);
      min-height:100vh;
    }

    .wrap{
      max-width: 860px;
      margin: 0 auto;
      padding: 18px 16px 28px;
    }

    header{
      text-align:center;
      padding: 10px 0 6px;
    }

    h1{
      margin: 10px 0 8px;
      color: var(--mint-dark);
      font-weight: 600;
      letter-spacing: 0.6px;
      position: relative;
      display:inline-block;
      padding-bottom: 10px;
    }
    h1::after{
      content:"";
      display:block;
      width: 150px;
      height: 3px;
      background: linear-gradient(to right, var(--mint-1), var(--mint-2));
      margin: 10px auto 0;
      border-radius: 999px;
    }

    .subtitle{
      margin: 6px auto 10px;
      max-width: 720px;
      font-size: 14.5px;
      line-height: 1.55;
      color: rgba(31,41,55,0.85);
    }

    .topbar{
      display:flex;
      gap: 12px;
      align-items:center;
      justify-content:space-between;
      margin: 10px auto 14px;
      padding: 12px 14px;
      background: var(--card);
      border: var(--border);
      border-radius: 16px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
    }

    .qcount{
      font-size: 14px;
      color: rgba(6,95,70,0.9);
      font-weight: 600;
      white-space: nowrap;
    }

    .progress{
      flex:1;
      height: 10px;
      border-radius: 999px;
      background: rgba(6,95,70,0.10);
      overflow:hidden;
      border: 1px solid rgba(6,95,70,0.12);
    }
    .progress > div{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--mint-1), var(--mint-2));
      border-radius: 999px;
      transition: width .35s ease;
    }

    .card{
      background: var(--card);
      border: var(--border);
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: 18px;
      backdrop-filter: blur(6px);
      animation: fadeIn .45s ease;
    }

    @keyframes fadeIn{
      from{opacity:0; transform: translateY(10px);}
      to{opacity:1; transform: translateY(0);}
    }

    .qtitle{
      margin: 0 0 14px;
      font-size: 18px;
      line-height: 1.55;
      color: rgba(31,41,55,0.95);
    }

    .answers{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    button.answer{
      width:100%;
      border:none;
      border-radius: 14px;
      padding: 14px 14px;
      background: var(--mint-1);
      color: #064e3b;
      font-size: 16px;
      line-height: 1.35;
      cursor:pointer;
      transition: transform .18s ease, background .25s ease, box-shadow .25s ease;
      box-shadow: 0 6px 14px rgba(6,95,70,0.08);
      text-align:left;
    }
    button.answer::before{
      content:"✦ ";
      opacity:0.65;
      font-size: 14px;
    }
    button.answer:hover{
      background: var(--mint-2);
      transform: translateY(-2px);
      box-shadow: 0 10px 18px rgba(6,95,70,0.10);
    }
    button.answer:active{
      transform: translateY(0px);
    }

    .nav{
      display:flex;
      gap:10px;
      margin-top: 14px;
      flex-wrap:wrap;
    }

    .ghost{
      background: transparent;
      border: 1px solid rgba(6,95,70,0.25);
      color: var(--mint-dark);
      box-shadow:none;
    }
    .ghost:hover{
      background: rgba(110,231,183,0.20);
    }

    .result{
      background: #ecfdf5;
      border: 1px solid rgba(6,95,70,0.18);
      border-radius: 16px;
      box-shadow: 0 10px 22px rgba(0,0,0,0.06);
      padding: 18px;
      line-height: 1.75;
      color: rgba(6,95,70,0.95);
    }
    .result h2{
      margin: 0 0 8px;
      color: var(--mint-dark);
      font-size: 22px;
      letter-spacing: .2px;
    }
    .result p{
      margin: 10px 0 0;
      color: rgba(31,41,55,0.88);
      font-size: 15.5px;
      line-height: 1.75;
      font-family: "Georgia", serif;
    }

    footer{
      text-align:center;
      font-size: 12.5px;
      color: rgba(31,41,55,0.55);
      margin-top: 14px;
      padding: 10px 0 0;
    }

    /* Mobil iyileştirme */
    @media (max-width: 520px){
      .qtitle{font-size: 17px;}
      button.answer{font-size: 15.5px; padding: 13px;}
      .topbar{flex-direction:column; align-items:stretch;}
      .qcount{text-align:center;}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>Hangi Sahabesin?</h1>
      <div class="subtitle">
        Bu test; değerlerin, reflekslerin, hayata bakışın ve bazı “keyfi seçimlerin” üzerinden bir karakter profili çıkarır.
        Soruları içten cevapla; “doğru cevap” yoktur.
      </div>
    </header>

    <div class="topbar">
      <div class="qcount" id="qcount">Soru 1 / 36</div>
      <div class="progress" aria-label="İlerleme çubuğu">
        <div id="pbar"></div>
      </div>
    </div>

    <div class="card" id="app"></div>

    <footer>
      Krem & mint tema • mobil uyumlu • tek dosya (index.html)
    </footer>
  </div>

<script>
  // 12 sahabe (sonuç isimleri)
  const SAHABE = [
    "Hz. Ebû Bekir",
    "Hz. Ömer",
    "Hz. Osman",
    "Hz. Ali",
    "Hâlid bin Velîd",
    "Bilâl-i Habeşî",
    "Selmân-ı Fârisî",
    "Cafer bin Ebî Tâlib",
    "Nuaymân",
    "Ebû Zer el-Gıfârî",
    "Amr bin Âs",
    "Abdullah bin Revâha"
  ];

  // Puan tablosu
  const scores = Object.fromEntries(SAHABE.map(n => [n, 0]));

  // 36 soru (30-36 uzun versiyon dahil)
  const QUESTIONS = [
    {
      q: "Issız bir adaya düştüğünü düşün. Kurtarılacağın kesin değil. Günlerce yalnız kalabilirsin. Yanında yalnızca bir şey götürme hakkın var. Seni ayakta tutacak şey hangisi olurdu?",
      a: ["Uzun süre zihnimi besleyecek bir kitap", "Kendimi koruyabileceğim bir araç", "Düşüncelerimi yazabileceğim defter ve kalem", "Yanımda olacak güvenilir bir dost"]
    },
    {
      q: "Uzun süredir herkesin moralinin bozuk olduğu bir ortamdasın. İnsanlar umudunu kaybetmeye başlamış. Senin doğal olarak yaptığın şey hangisidir?",
      a: ["İnsanların kalbini toparlayacak sözler söylemek", "“Bu böyle gitmez” deyip düzen kurmak", "Çıkış yolu arayıp çözüm üretmek", "Havayı yumuşatıp moral yükseltmek"]
    },
    {
      q: "Gece yalnızken, hiçbir şey dikkatini dağıtmazken zihnin en çok nereye gider?",
      a: ["Hayatın anlamını ve hikmetini düşünmeye", "Gerçeği aramaya ve sorgulamaya", "Geçmişteki niyetlerimi muhasebeye", "İnsanların hâlini ve dertlerini düşünmeye"]
    },
    {
      q: "Bir haksızlık gördüğünde seni en çok rahatsız eden şey hangisidir?",
      a: ["Birinin incinmiş olması", "Adalet duygusunun çiğnenmesi", "Doğrunun savunulmamış olması", "Olayın arkasındaki gerçeğin anlaşılmaması"]
    },
    {
      q: "Sana yeni bir şehir kurma görevi verilse, ilk önce en sağlam kurmak isteyeceğin temel hangisi olurdu?",
      a: ["İnsanların birbirine güveneceği bir sosyal yapı", "Adil işleyen bir düzen ve hukuk", "Güçlü savunma ve güvenlik", "İlim, eğitim ve düşünce merkezi"]
    },
    {
      q: "Çok uzun süren bir zorluk döneminde, seni ayakta tutan asıl güç hangisidir?",
      a: ["Sabırla dayanma gücüm", "Mücadele etme isteğim", "Umudu diri tutma çabam", "İç muhasebe ve kendimi kontrol"]
    },
    {
      q: "Bir filmde kendine en yakın bulacağın rol hangisi olurdu?",
      a: ["Sakin ve derin düşünen bilge", "Haksızlığa karşı duran lider", "Zamanı ve hamleyi bilen stratejist", "Ortamı ayakta tutan moral kaynağı"]
    },
    {
      q: "Bir yolculuğa çıkarken çantana koyduğun şey seni temsil ediyor olsa, hangisi daha çok “sen” olurdu?",
      a: ["Okuyacak bir kitap", "Yolu gösteren harita", "Dayanıklılık için su/malzeme", "Hatıra değeri olan bir eşya"]
    },
    {
      q: "Geçmişini düşündüğünde seni en çok düşündüren, içini en çok yoklayan şey hangisi olur?",
      a: ["Birini farkında olmadan incitmiş olmak", "Yanlış karşısında susmuş olmak", "Gerçeği geç fark etmiş olmak", "Niyetimde bir bozulma ihtimali"]
    },
    {
      q: "Bir tartışmada sen daha çok ne yaparsın?",
      a: ["Kalpleri korumaya çalışırım", "Doğruyu savunurum", "Sebep-sonuç analizi yaparım", "Ortamı yumuşatırım"]
    },
    {
      q: "Bir şehirde düzen bozuluyor: sence ilk toparlanması gereken şey hangisidir?",
      a: ["Güven ve merhamet iklimi", "Kurallar ve adalet", "Stratejik plan ve organizasyon", "Moral ve umut"]
    },
    {
      q: "Zor bir karar anında, seni en çok yönlendiren şey hangisidir?",
      a: ["Kalbimdeki huzur ve niyet", "İlke ve doğru olan", "Analiz ve uzun vadeli sonuç", "Bu kararın hayatımdaki anlamı"]
    },
    {
      q: "Hayatının en zor dönemlerinden birini düşün. Seni en çok büyüten şey hangisine benzerdi?",
      a: ["Birine destek olabilmek", "Sorumluluk alıp yük taşımak", "Olanları anlamlandırmak", "Nefsle yüzleşmek"]
    },
    {
      q: "Yanlış bir şey oluyor ve herkes susuyor. Senin eğilimin hangisi?",
      a: ["Kimse kırılmasın diye dikkatle yaklaşmak", "Açıkça durmak ve itiraz etmek", "En doğru hamleyi planlamak", "Bu yanlışın kökünü düşünmek"]
    },
    {
      q: "Sence gerçek liderlik hangisine daha yakındır?",
      a: ["İnsanları korumak", "Adaleti ayakta tutmak", "Doğru zamanı ve hamleyi bilmek", "İnsanlara anlam kazandırmak"]
    },
    {
      q: "Sessizlik senin için ne ifade eder?",
      a: ["İç huzur", "Düşünme alanı", "Sabır ve dayanma", "İç hesaplaşma"]
    },
    {
      q: "Bir topluluk dağılmaya yüz tutmuşsa, doğal olarak sen ne yaparsın?",
      a: ["İnsanların yükünü paylaşırım", "Düzeni kurarım", "Plan çıkarırım", "Bağı güçlendiririm"]
    },
    {
      q: "Hayat seni daha çok hangi yöne evirdi?",
      a: ["Daha merhametli yaptı", "Daha net yaptı", "Daha derinleştirdi", "Daha dayanıklı yaptı"]
    },
    {
      q: "Geleceğe dair hayalini düşün. Seni en çok heyecanlandıran hedef hangisidir?",
      a: ["İnsanlara fayda ve şefkat", "Adil bir yapının parçası olmak", "Hakikate yaklaşmak", "Büyük bir zorluğu aşmak"]
    },
    {
      q: "Bir ortamda seni en çok yoran şey hangisidir?",
      a: ["İnsanların birbirini kırması", "Yanlışın normalleşmesi", "Yüzeysellik", "Nefsle mücadele"]
    },
    {
      q: "Birine kızdığında iç dünyanda en baskın olan şey hangisi olur?",
      a: ["Kırmamak için kendimi tutarım", "Doğruyu söyleme isteğim artar", "Önce sebebi anlamaya çalışırım", "Kendimi sorgularım"]
    },
    {
      q: "Senin için güç daha çok nedir?",
      a: ["Başkasına yük olmamak", "Doğru durabilmek", "Durumu yönetebilmek", "Zorlukta çözülmemek"]
    },
    {
      q: "Hayatta seni en çok yönlendiren soru hangisidir?",
      a: ["Birine zarar verdim mi?", "Doğru olanı yaptım mı?", "Gerçeği gördüm mü?", "Niyetim temiz mi?"]
    },
    {
      q: "Bir ortam gerildiğinde sen hangisine daha yatkınsın?",
      a: ["Sakinleştirmeye", "Netleştirmeye", "Analiz etmeye", "Mizahla yumuşatmaya"]
    },
    {
      q: "İnsanların seni en çok hangi yönünle tanımasını isterdin?",
      a: ["Güvenilirlik", "Adaletli duruş", "Bilgelik/derinlik", "Dayanıklılık"]
    },
    {
      q: "Hayatta seni en çok korkutan şey hangisidir?",
      a: ["Birinin kalbini kırmak", "Haksız kalmak", "Gerçekten uzak yaşamak", "İmanın zayıflaması"]
    },
    {
      q: "Bir toplulukta sence en eksik kalan şey çoğu zaman hangisidir?",
      a: ["Güven", "İlke", "Anlayış", "Moral"]
    },
    {
      q: "İnsanlarla ilgili en çok hangi tür cümle seni harekete geçirir?",
      a: "“Birilerinin sana ihtiyacı var.”",
      a: ["“Birilerinin sana ihtiyacı var.”", "“Bu doğru değil.”", "“Bunun gerçeği ne?”", "“Buna çözüm bulmalıyız.”"]
    },

    // 28-29
    {
      q: "Bir toplulukta “başarı” denince senin zihninde hangisi daha ağır basar?",
      a: ["İnsanların huzuru", "Doğrunun gerçekleşmesi", "Anlamın bulunması", "Zorluğun aşılması"]
    },
    {
      q: "Hayatın seni en çok eğittiği yer neresiydi?",
      a: ["Zorluklar", "Sorumluluklar", "Düşünceler", "İç mücadele"]
    },

    // 30-36 (uzun versiyonlar)
    {
      q: "Bir davanın, bir idealin ya da uğruna emek verdiğin bir yolun içindesin. Yorulmuşsun ama bırakma noktasına gelmemişsin. Seni yeniden ayağa kaldıran asıl motivasyon hangisi olur?",
      a: ["“Birilerinin buna ihtiyacı var, yalnız değiller.”", "“Bu doğru olan, vazgeçemem.”", "“Bu yol beni hakikate yaklaştırıyor.”", "“Zor olsa da mücadele etmeden olmaz.”"]
    },
    {
      q: "Hayatının dönüm noktalarını düşündüğünde seni en çok olgunlaştıran tecrübe hangisine benzer?",
      a: ["Birinin kalbine dokunduğunu fark ettiğin anlar", "Sorumluluk alıp ağır bir yük taşıdığın dönemler", "Olayların arkasındaki anlamı kavradığın fark edişler", "Zor şartlara rağmen ayakta kaldığın süreçler"]
    },
    {
      q: "Herkes uyuduğunda, gece sessizliğinde yalnız kaldığında seni ayakta tutan iç dayanak hangisidir?",
      a: ["Sevdiğim insanların varlığı ve bağ hissi", "İnandığım ilkeler ve doğru bildiğim çizgi", "Düşüncelerim ve zihinsel derinliğim", "İmanım ve sabır gücüm"]
    },
    {
      q: "İnsanların seni yıllar sonra hatırladığını düşün. Hangi yönünle anılmak seni en çok mutlu ederdi?",
      a: ["İyilik etmiş, kalplere dokunmuş biri olarak", "Duruşu net, adaletli ve ilkeli biri olarak", "Sözü derin, bilge biri olarak", "Zorluklarda çözülmemiş, sabırlı biri olarak"]
    },
    {
      q: "Bir topluluğa dışarıdan baktığında, onların en çok hangi eksiği olduğunu düşünürsün?",
      a: ["Güven ve merhamet", "İlke ve adalet", "Derinlik ve anlam arayışı", "Moral, umut ve ruh hafifliği"]
    },
    {
      q: "Hayatta en zor ama en doğru olduğunu bildiğin davranış hangisidir?",
      a: ["Seni incitmiş birini affedebilmek", "Yanlış karşısında yalnız kalsan da karşı durmak", "Her şeyi sorgulayıp gerçeği aramaya devam etmek", "Uzun süren bir zorlukta sabredip çözülmemek"]
    },
    {
      q: "Hayatın özünü tek bir kavramla anlatman istense, hangisi senin dünyanı en iyi ifade ederdi?",
      a: ["İnsan – kalp, bağ ve merhamet", "Adalet – doğru olanı ayakta tutmak", "Hakikat – anlamı bulma yolculuğu", "Mücadele – düşmemek ve ayağa kalkmak"]
    }
  ];

  // Yukarıdaki listede bir kez yazım hatası olduysa diye güvenlik:
  // (bazı tarayıcılarda aynı key tekrar edilirse sorun çıkarmasın)
  // Soruları normalize edelim:
  const normalized = QUESTIONS.map(q => ({
    q: q.q,
    a: Array.isArray(q.a) ? q.a : []
  })).filter(x => x.q && x.a.length === 4);

  // Eğer yanlışlıkla 36'ya ulaşmadıysa: (kullanıcı istemediği için otomatik eklemiyorum)
  // Ama biz net 36 istiyoruz:
  if (normalized.length !== 36) {
    console.warn("Soru sayısı 36 değil:", normalized.length);
  }

  // Adil eşleme:
  // Her sorunun A/B/C/D seçenekleri, sahabelere döngüsel şekilde atanır.
  // Böylece toplam 36*4=144 seçenek, 12 sahabeye eşit dağılır => her sahabe 12 kez seçenek olarak gelir.
  function sahabeFor(questionIndex, optionIndex){
    return SAHABE[(questionIndex + optionIndex) % SAHABE.length];
  }

  // Uzun sonuç metinleri (12 sahabe)
  const RESULT_TEXT = {
    "Hz. Ebû Bekir": `Senin karakterinde “sadakat, yumuşak güç ve güven” öne çıkıyor. İnsanları kazanmayı, kırmadan yön vermeyi ve zorlu günlerde bile kalpten bir istikrar göstermeyi önemsiyorsun. Panik anlarında bile “önce niyet, sonra adım” diyebilen bir tarafın var. Zor şartlarda etrafın dağılmasın diye kimsenin görmediği yükleri sırtlamaya yatkınsın. Bu, seni hem güvenilir hem de toparlayıcı yapar; fakat bazen kendini fazla ihmal etmeye açık bir çizgi olabilir. Dengen; merhametini korurken sınır koymayı da öğrenmende güçlenir.`,
    "Hz. Ömer": `Senin damarında “adalet, netlik ve sorumluluk” akıyor. Belirsizlik seni yorar; doğruyu bulduğunda ise onu savunmakta çekingen davranmazsın. İnsanların iyiliği için sınır çizmekten, yanlışın önüne set çekmekten kaçınmazsın. Güçlü tarafın: zor anlarda bile ayakta bir ilke taşıman. Dikkat edilmesi gereken tarafın: bazen hızla karar verirken kalpleri incitmemek için üslubu yumuşatmayı hatırlamak. Doğruyu korurken merhameti kaybetmediğinde “tam liderlik” sende belirginleşir.`,
    "Hz. Osman": `Sende “zarafet, sükûnet ve incelik” baskın. Sertlik seni yorar; ortamın yumuşamasını, kalplerin kırılmamasını ve birliğin korunmasını çok önemsersin. İnsanları gözlemleyip büyütürken, genelde gerginliği düşüren taraf olursun. Gücün, “kimseyi ezmeden” iyiliğe çağırmak ve ortamı toparlamaktır. Zayıf noktan, bazen yanlış karşısında fazla sabırlı kalarak gecikmek olabilir. Senin dengen; yumuşaklığını korurken gerektiğinde netliği de taşıyabilmendir.`,
    "Hz. Ali": `Senin yapında “derinlik, hikmet ve anlam arayışı” çok güçlü. Yüzeyde kalmak seni tatmin etmez; olayların arkasındaki hakikati ve kalıcı manayı ararsın. Düşünce gücün yüksektir; bu yüzden çoğu insanın kaçırdığı detayları yakalayabilirsin. Güçlü tarafın: zor meselelerde bile zihnini berraklaştırıp doğru yere bakabilmek. Zorluk tarafı: bazen fazla düşünmek, harekete geçmeyi geciktirebilir. Senin dengin; derinliğini korurken adımı geciktirmeden atabilmendir.`,
    "Hâlid bin Velîd": `Sende “cesaret, mücadele ruhu ve eylem enerjisi” belirgin. Zor şartlar seni yıldırmaktan çok toplar; krizde “ne yapmalıyız?” diyerek harekete geçersin. Risk almaktan korkmazsın ama bunu amaçsız değil, sonuç üretmek için yaparsın. Gücün: güçlü irade ve dayanıklılık. Dikkat edilmesi gereken nokta: bazen hız, etrafın duygusunu geride bırakabilir. Senin en parlak hâlin; gücünü hikmetle ve doğru zamanlamayla birleştirdiğinde ortaya çıkar.`,
    "Bilâl-i Habeşî": `Senin karakterinde “sabır, sebat ve imanla dayanma” çok güçlü. Zor zamanlarda bile iç dengen kolay bozulmaz; acının içinden bile istikamet çıkarmayı bilirsin. Sessizlikten güç alabilir, yalnız kalsan da yolunu kaybetmeyebilirsin. Gücün: uzun vadeli dayanıklılık ve sadelik. Zorluk tarafı: bazen kendini fazla geri planda tutmak olabilir. Senin dengin; sabrını korurken gerektiğinde sesini duyurmaya da izin vermendir.`,
    "Selmân-ı Fârisî": `Sende “arayış, hakikat tutkusu ve geniş ufuk” öne çıkıyor. Sıradan cevaplar seni doyurmaz; derine inmek, kökü bulmak istersin. Zihnin, farklı kültürlerden ve farklı bakışlardan beslenmeye açıktır. Gücün: anlamı bulana kadar yola devam edebilmek. Zorluk tarafı: bazen fazla sorgulamak duygusal yorgunluk doğurabilir. Senin dengen; arayışını sürdürürken kalbine de dinlenme alanı açmandır.`,
    "Cafer bin Ebî Tâlib": `Senin tarafında “fedakârlık, temsil gücü ve ikna” belirgin. İnsanları bir arada tutan bağları güçlendirmeye yatkınsın; gerektiğinde kendinden vererek bir denge kurabilirsin. Konuştuğunda insanların içine umut düşürme ve “kalpten” ikna etme tarafın var. Gücün: hem zarafet hem kararlılığı birlikte taşıyabilmek. Zorluk tarafı: bazen çok yüklenmek ve kendini unutmak olabilir. Dengen; fedakârlığını bilinçli sınırlarla korumanla güçlenir.`,
    "Nuaymân": `Sende “neşe, moral ve hayata ferahlık katma” yönü güçlü. İnsanların tıkandığı yerde havayı yumuşatıp nefes aldırabilirsin. Mizahı sadece eğlence için değil, bazen bir hikmet kapısı olarak da kullanırsın. Gücün: zor anda bile umut kıvılcımı yakmak. Zorluk tarafı: bazen ciddiyet isteyen anlarda doğru dozu ayarlamak gerekebilir. Dengen; neşeni korurken hedefi unutmadan yürümenle ortaya çıkar.`,
    "Ebû Zer el-Gıfârî": `Senin içinde “hak, dürüstlük ve taviz vermeme” karakteri baskın. Yanlışın üstünü örtmek sana göre değil; doğruyu söylemek ve haksızlığa itiraz etmek iç refleksin gibi. Gücün: temiz bir vicdan ve net bir duruş. Zorluk tarafı: zaman zaman yalnız kalma pahasına da olsa doğruyu söylemen, iletişimi zorlayabilir. Senin dengin; hakikati savunurken muhatabın kalbine de kapı aralayabilmendir.`,
    "Amr bin Âs": `Sende “strateji, zeka ve doğru hamleyi görme” yeteneği belirgin. Büyük resmi okumayı seversin; kargaşada bile soğukkanlılıkla plan çıkarabilirsin. Gücün: analiz, organizasyon ve zamanlama. Zorluk tarafı: bazen fazla hesap, duygusal bağları ikinci plana itebilir. Dengen; zekânı hikmet ve merhametle birleştirmenle en güçlü hâlini alır.`,
    "Abdullah bin Revâha": `Sende “iç muhasebe, samimiyet ve sözün gücü” öne çıkıyor. Duygu ve anlam dünyan güçlü; bazen bir cümleyle insanın içini açabilecek bir tarafın var. Kendini sık sık kontrol edip niyetini temiz tutmaya çalışırsın. Gücün: samimi bir derinlik ve iç disiplin. Zorluk tarafı: fazla yüklenip kendini ağır eleştirmek olabilir. Dengen; muhasebeyi umuda ve eyleme dönüştürmende güçlenir.`
  };

  const app = document.getElementById("app");
  const qcount = document.getElementById("qcount");
  const pbar = document.getElementById("pbar");

  let idx = 0;
  let answersHistory = [];

  function setProgress(){
    const total = 36;
    const current = Math.min(idx + 1, total);
    qcount.textContent = `Soru ${current} / ${total}`;
    pbar.style.width = `${(idx / total) * 100}%`;
  }

  function renderQuestion(){
    setProgress();

    const q = normalized[idx];
    const html = `
      <div class="qtitle">${idx+1}. ${escapeHtml(q.q)}</div>
      <div class="answers">
        ${q.a.map((txt, o) => {
          const who = sahabeFor(idx, o);
          return `<button class="answer" type="button" onclick="pick(${o})">${escapeHtml(txt)}</button>`;
        }).join("")}
      </div>
      <div class="nav">
        <button class="answer ghost" type="button" onclick="restart()">Baştan Başla</button>
        ${idx>0 ? `<button class="answer ghost" type="button" onclick="back()">Geri</button>` : ``}
      </div>
    `;
    app.innerHTML = html;
  }

  function pick(optionIndex){
    const who = sahabeFor(idx, optionIndex);
    scores[who] += 1;
    answersHistory.push({idx, optionIndex, who});
    idx++;
    if(idx >= 36){
      showResult();
      return;
    }
    renderQuestion();
  }

  function back(){
    if(idx <= 0) return;
    const last = answersHistory.pop();
    if(last){
      scores[last.who] -= 1;
      idx = last.idx;
    } else {
      idx = Math.max(0, idx-1);
    }
    renderQuestion();
  }

  function restart(){
    for(const k of Object.keys(scores)) scores[k] = 0;
    idx = 0;
    answersHistory = [];
    renderQuestion();
  }

  function showResult(){
    pbar.style.width = "100%";
    qcount.textContent = `Bitti • 36 / 36`;

    // en yüksek
    let max = -Infinity;
    for(const name of SAHABE) max = Math.max(max, scores[name]);

    // tie varsa sabit sırayla seç (deterministik)
    const top = SAHABE.filter(n => scores[n] === max);
    const winner = top[0];

    const text = RESULT_TEXT[winner] || "Sonuç metni hazırlanıyor.";
    app.innerHTML = `
      <div class="result">
        <h2>Sonuç: ${escapeHtml(winner)}</h2>
        <p>${escapeHtml(text)}</p>
      </div>
      <div class="nav">
        <button class="answer" type="button" onclick="restart()">Tekrar Çöz</button>
      </div>
    `;
  }

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  // Başlat
  renderQuestion();
</script>
</body>
</html>
